import{K as k,P as W,S as C}from"./index-4d792b2f.js";import{_ as E}from"./WebCard-852e973e.js";import{f as O,ag as B,K as L,r as f,c as I,w as _,h as i,S as m,U as p,i as N,l as A,u as b,af as M,k as P}from"./vue-5f6c84d3.js";const V=P("i",{class:"iconfont fw-600 icon-add"},null,-1),J=[V],D=O({__name:"CardList",props:{catId:{}},setup(g){const a=g,v=M(()=>C(()=>import("./vuedraggable.umd-35f24fd1.js").then(e=>e.v),["./vuedraggable.umd-35f24fd1.js","./index-4d792b2f.js","./vue-5f6c84d3.js","./tools-8f8edc89.js","./index-d3e98782.css"],import.meta.url)),c=k(),d=W(),{appendWeb:h}=B(d),w=L("showWebModal"),u=f(0),l=f(-1),s=I(()=>{let e=[];a.catId==="cat@often"?e=c.allWebs.filter(t=>t.isOften):a.catId==="cat@fly"?e=c.allWebs.filter(t=>t.isFly):e=c.allWebs.filter(t=>t.catIds.includes(a.catId));const o=utools.dbStorage.getItem("sort_web@"+a.catId)??[];if(e.sort((t,n)=>{const r=o.indexOf(t._id);return o.indexOf(n._id)-r}),l.value!=-1){const t=e.splice(u.value,1)[0];e.splice(l.value,0,t),l.value=-1}return e});_(()=>h.value,(e,o)=>{if(e&&e!==o){const t=s.value.findIndex(r=>r._id==e._id),n=s.value.findIndex(r=>r._id==d.theId);n!=-1&&(s.value[t]=s.value.splice(n+1,1,s.value[t])[0])}});const x=e=>{if(e.moved){u.value=e.moved.oldIndex;const o=s.value.length;e.moved.newIndex<o&&(l.value=e.moved.newIndex)}},y=I(()=>{const e=s.value.map(o=>o._id)??[];return JSON.stringify(e)});_(y,(e,o)=>{e.length===2?utools.dbStorage.removeItem("sort_web@"+a.catId):utools.dbStorage.setItem("sort_web@"+a.catId,JSON.parse(e).reverse())});const S=()=>{d.changeEditMode("add"),d.getEcatId(a.catId),w.value=!0};return(e,o)=>{const t=E;return i(),m(b(v),{class:"grid grid-cols-3 lg:grid-cols-4 gap-3",tag:"ul",list:b(s),group:"websList"+e.catId,"item-key":"_id",onChange:x},{item:p(({element:n})=>[(i(),m(t,{web:n,catId:e.catId,key:n._id},null,8,["web","catId"]))]),footer:p(()=>[["cat@often","cat@dustbin","cat@fly"].includes(e.catId)?A("",!0):(i(),N("li",{key:0,class:"add-item flex-center p-4 cursor-pointer dark:op-30",border:"dashed 2 [var(--el-border-color)] hover:[var(--el-color-primary-light-5)]",text:"[var(--el-color-info-light-5)] hover:[var(--el-color-primary-light-5)]",style:{"border-radius":"var(--el-border-radius-base)"},onClick:S},J))]),_:1},8,["list","group"])}}});export{D as _};
