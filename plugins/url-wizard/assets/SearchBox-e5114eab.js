import{K as W,Q as K,R as V,b as L}from"./index-4d792b2f.js";import{E as N}from"./empty-45c6f422.js";import{_ as U}from"./WebCard-852e973e.js";import{f as j,K as b,c as z,d as D,q as F,j as u,v as d,u as a,h as p,i as v,k as c,a9 as _,t as M,W as f,U as q,X as Q,ab as R,S as T,m as X,at as A,e as G}from"./vue-5f6c84d3.js";import{b as H}from"./tools-8f8edc89.js";import"./avatar-013be683.js";import"./useNoteStore-185ebad8.js";import"./index-425c5bd9.js";import"./index-82cfccb5.js";import"./index-71ce9d2a.js";import"./validator-bd157353.js";const J={class:"search-box z-1000"},O={class:"flex-y-center px-5 pt-5 pb-2"},P={class:"text-muted"},Y={class:"text-red fw-700 px-1"},Z=A('<div class="ml-auto flex-y-center text-muted"><kbd class="kbd">↑</kbd><kbd class="kbd">↓</kbd><kbd class="kbd">←</kbd><kbd class="kbd">→</kbd><span class="me-3">切换</span><kbd class="kbd">Enter</kbd>打开 </div>',1),$={class:"grid grid-cols-3 lg:grid-cols-4 gap-3"},_e=j({__name:"SearchBox",setup(ee){const g=W(),l=K(),n=b("searchKeyWord"),s=z(()=>g.allWebs.filter(t=>{let r="";if(l.setting.search.includes("desc")&&(r+=t.desc.toLowerCase()),l.setting.search.includes("url")){const i=t.url.replace(/https?:\/\/(www\.)?/,"").split(".").slice(0,2).join("");r+=i}return(V.match(t.title,n.value)||r.includes(n.value.toLowerCase()))&&!t.catIds.includes("cat@dustbin")})),x=()=>{utools.setSubInputValue("")},e=b("searchIndex"),{arrowup:k,arrowdown:w,arrowleft:S,arrowright:y,enter:B,esc:se}=H();let o=null;const E=()=>{o=G(()=>{if((k.value||S.value)&&e.value>-1&&(e.value-=1),(w.value||y.value)&&e.value<s.value.length-1&&(e.value+=1),e.value>-1&&e.value<s.value.length&&B.value){const t=s.value[e.value];l.openLink(t)}e.value===-1&&utools.subInputFocus(),e.value>-1&&utools.subInputBlur()})};return D(()=>{E()}),F(()=>{o==null||o()}),(t,r)=>{const h=U,i=N,I=L;return u((p(),v("div",J,[c("div",O,[c("h3",{class:"fw-600 text-16px cursor-pointer flex-y-center"},[c("i",{class:"iconfont icon-back text-20px mr-2",onClick:x}),_("搜索结果： ")]),u(c("span",P,[_("（共找到 "),c("code",Y,M(a(s).length),1),_("张相关的卡片） ")],512),[[d,a(s).length>0]]),Z]),f(I,{class:"search-area",height:"calc(100vh - 80px)","wrap-class":"main-warp","view-class":"search-view p-16px"},{default:q(()=>[c("ul",$,[(p(!0),v(Q,null,R(a(s),(m,C)=>(p(),T(h,{web:m,class:X({"sbg-primary!":C==a(e)}),catId:"cat@search",key:m._id},null,8,["web","class"]))),128))]),u(f(i,{description:"抱歉,没有找到"},null,512),[[d,a(s).length==0]])]),_:1})],512)),[[d,a(n).length>0]])}}});export{_e as default};
