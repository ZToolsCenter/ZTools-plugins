"use strict";var Buffer=require("safer-buffer").Buffer;module.exports=function(t){var n=t.Transform;function r(t,r){this.conv=t,(r=r||{}).decodeStrings=!1,n.call(this,r)}function o(t,r){this.conv=t,(r=r||{}).encoding=this.encoding="utf8",n.call(this,r)}return r.prototype=Object.create(n.prototype,{constructor:{value:r}}),r.prototype._transform=function(t,n,r){if("string"!=typeof t)return r(new Error("Iconv encoding stream needs strings as its input."));try{var o=this.conv.write(t);o&&o.length&&this.push(o),r()}catch(t){r(t)}},r.prototype._flush=function(t){try{var n=this.conv.end();n&&n.length&&this.push(n),t()}catch(n){t(n)}},r.prototype.collect=function(t){var n=[];return this.on("error",t),this.on("data",(function(t){n.push(t)})),this.on("end",(function(){t(null,Buffer.concat(n))})),this},o.prototype=Object.create(n.prototype,{constructor:{value:o}}),o.prototype._transform=function(t,n,r){if(!(Buffer.isBuffer(t)||t instanceof Uint8Array))return r(new Error("Iconv decoding stream needs buffers as its input."));try{var o=this.conv.write(t);o&&o.length&&this.push(o,this.encoding),r()}catch(t){r(t)}},o.prototype._flush=function(t){try{var n=this.conv.end();n&&n.length&&this.push(n,this.encoding),t()}catch(n){t(n)}},o.prototype.collect=function(t){var n="";return this.on("error",t),this.on("data",(function(t){n+=t})),this.on("end",(function(){t(null,n)})),this},{IconvLiteEncoderStream:r,IconvLiteDecoderStream:o}};