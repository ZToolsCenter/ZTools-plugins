"use strict";const path=require("path"),cp=require("child_process"),os=require("os"),addon="x64"===process.arch?require("./addon-x64.node"):{};function checkIsSupportRecorder(){if("win32"!==process.platform)return!1;if("x64"!==process.arch)return!1;const r=os.release().split(".");return!(parseInt(r[0])<10||parseInt(r[2])<18362)}function capture(r,e,o,t,n,s){const c=new Promise((c,p)=>{if(!checkIsSupportRecorder())return void p(new Error("not supported"));const a=path.join(__dirname.replace(/([a-f0-9]{32}.asar)/,"$1.unpacked"),"capture-x64.exe"),i=[String(r),String(e),o&&t?"3":o?"1":t?"2":"0",n?"1":"0",s],u=cp.spawn(a,i);u.on("exit",(r,e)=>{r>0?p(new Error("异常退出")):c()}),u.on("error",r=>{addon.quit(),p(r)})});return c.quit=addon.quit,c}module.exports=capture;